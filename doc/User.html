<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class User - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
  var index_rel_prefix = "./";
</script>

<script src="./js/navigation.js" defer></script>
<script src="./js/search.js" defer></script>
<script src="./js/search_index.js" defer></script>
<script src="./js/searcher.js" defer></script>
<script src="./js/darkfish.js" defer></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">


<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search (/) for a class, method, ..." spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    
<div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  <p class="link"><a href="ApplicationRecord.html">ApplicationRecord</a>
</div>

    
    
    
<!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    <li ><a href="#method-c-digest">::digest</a>
    <li ><a href="#method-c-new_token">::new_token</a>
    <li ><a href="#method-i-activate">#activate</a>
    <li ><a href="#method-i-authenticated-3F">#authenticated?</a>
    <li ><a href="#method-i-create_reset_digest">#create_reset_digest</a>
    <li ><a href="#method-i-feed">#feed</a>
    <li ><a href="#method-i-forget">#forget</a>
    <li ><a href="#method-i-password_reset_expired-3F">#password_reset_expired?</a>
    <li ><a href="#method-i-remember">#remember</a>
    <li ><a href="#method-i-send_activation_email">#send_activation_email</a>
    <li ><a href="#method-i-send_password_reset_email">#send_password_reset_email</a>
    <li ><a href="#method-i-session_token">#session_token</a>
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-User">
  <h1 id="class-User" class="class">
    class User
  </h1>

  <section class="description">
    
<p>This model represents a user in the application. It has many videos, with the videos being destroyed if the user is destroyed. It validates the presence and length of name and email, as well as the format and uniqueness of email. It also has secure password features, which validates the presence and length of password on creation. It also includes methods for remembering, forgetting, and authenticating users, as well as account activation and password reset.</p>

<p>Associations:</p>
<ul><li>
<p>has_many :videos, dependent: :destroy: Each user can have many videos. If the user is destroyed, its videos are also destroyed.</p>
</li></ul>

<p>Validations:</p>
<ul><li>
<p>‘name`: Ensures the presence of name and its length is maximum 50 characters.</p>
</li><li>
<p>‘email`: Ensures the presence of email, its length is maximum 255 characters, its format matches <a href="User.html#VALID_EMAIL_REGEX"><code>VALID_EMAIL_REGEX</code></a>, and it is unique (case insensitive).</p>
</li><li>
<p>‘password`: Ensures the presence of password on creation and its length is minimum 6 characters.</p>
</li></ul>

<p>Methods:</p>
<ul><li>
<p><a href="User.html#method-c-digest"><code>User.digest(string)</code></a>: Returns the hash digest of the given string.</p>
</li><li>
<p><a href="User.html#method-c-new_token"><code>User.new_token</code></a>: Returns a random token.</p>
</li><li>
<p>remember: Remembers a user in the database for use in persistent sessions.</p>
</li><li>
<p><a href="User.html#method-i-session_token"><code>session_token</code></a>: Returns a session token to prevent session hijacking.</p>
</li><li>
<p>authenticated?(attribute, token): Returns true if the given token matches the digest.</p>
</li><li>
<p>forget: Forgets a user.</p>
</li><li>
<p>activate: Activates an account.</p>
</li><li>
<p><a href="User.html#method-i-send_activation_email"><code>send_activation_email</code></a>: Sends activation email.</p>
</li><li>
<p><a href="User.html#method-i-create_reset_digest"><code>create_reset_digest</code></a>: Sets the password reset attributes.</p>
</li><li>
<p><a href="User.html#method-i-send_password_reset_email"><code>send_password_reset_email</code></a>: Sends password reset email.</p>
</li><li>
<p>password_reset_expired?: Returns true if a password reset has expired.</p>
</li><li>
<p>feed: Returns a user’s status feed.</p>
</li></ul>

  </section>

  <section id="5Buntitled-5D" class="documentation-section">


    <section class="constants-list">
      <header>
        <h3>Constants</h3>
      </header>
      <dl>
        <dt id="VALID_EMAIL_REGEX">VALID_EMAIL_REGEX
        <dd>
      </dl>
    </section>

    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      <div id="attribute-i-activation_token" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">activation_token</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        </div>
      </div>
      <div id="attribute-i-remember_token" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">remember_token</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        </div>
      </div>
      <div id="attribute-i-reset_token" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">reset_token</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        </div>
      </div>
    </section>


     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

      <div id="method-c-digest" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">digest</span><span
              class="method-args">(string)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Returns the hash digest of the given string.</p>

          <div class="method-source-code" id="digest-source">
            <pre><span class="ruby-comment"># File app/models/user.rb, line 45</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">User</span>.<span class="ruby-identifier ruby-title">digest</span>(<span class="ruby-identifier">string</span>)
  <span class="ruby-identifier">cost</span> = <span class="ruby-constant">ActiveModel</span><span class="ruby-operator">::</span><span class="ruby-constant">SecurePassword</span>.<span class="ruby-identifier">min_cost</span> <span class="ruby-operator">?</span> <span class="ruby-constant">BCrypt</span><span class="ruby-operator">::</span><span class="ruby-constant">Engine</span><span class="ruby-operator">::</span><span class="ruby-constant">MIN_COST</span> <span class="ruby-operator">:</span> <span class="ruby-constant">BCrypt</span><span class="ruby-operator">::</span><span class="ruby-constant">Engine</span>.<span class="ruby-identifier">cost</span>
  <span class="ruby-constant">BCrypt</span><span class="ruby-operator">::</span><span class="ruby-constant">Password</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">string</span>, <span class="ruby-value">cost:</span> <span class="ruby-identifier">cost</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-c-new_token" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">new_token</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Returns a random token.</p>

          <div class="method-source-code" id="new_token-source">
            <pre><span class="ruby-comment"># File app/models/user.rb, line 51</span>
<span class="ruby-keyword">def</span> <span class="ruby-constant">User</span>.<span class="ruby-identifier ruby-title">new_token</span>
  <span class="ruby-constant">SecureRandom</span>.<span class="ruby-identifier">urlsafe_base64</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

    </section>

     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

      <div id="method-i-activate" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">activate</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Activates an account.</p>

          <div class="method-source-code" id="activate-source">
            <pre><span class="ruby-comment"># File app/models/user.rb, line 81</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">activate</span>
  <span class="ruby-identifier">update_attribute</span>(<span class="ruby-value">:activated</span>, <span class="ruby-keyword">true</span>)
  <span class="ruby-identifier">update_attribute</span>(<span class="ruby-value">:activated_at</span>, <span class="ruby-constant">Time</span>.<span class="ruby-identifier">zone</span>.<span class="ruby-identifier">now</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-authenticated-3F" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">authenticated?</span><span
              class="method-args">(attribute, token)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Returns true if the given token matches the digest.</p>

          <div class="method-source-code" id="authenticated-3F-source">
            <pre><span class="ruby-comment"># File app/models/user.rb, line 69</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">authenticated?</span>(<span class="ruby-identifier">attribute</span>, <span class="ruby-identifier">token</span>)
  <span class="ruby-identifier">digest</span> = <span class="ruby-identifier">send</span>(<span class="ruby-node">&quot;#{attribute}_digest&quot;</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">digest</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-constant">BCrypt</span><span class="ruby-operator">::</span><span class="ruby-constant">Password</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">digest</span>).<span class="ruby-identifier">is_password?</span>(<span class="ruby-identifier">token</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-create_reset_digest" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">create_reset_digest</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Sets the password reset attributes.</p>

          <div class="method-source-code" id="create_reset_digest-source">
            <pre><span class="ruby-comment"># File app/models/user.rb, line 92</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_reset_digest</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">reset_token</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">new_token</span>
  <span class="ruby-identifier">update_attribute</span>(<span class="ruby-value">:reset_digest</span>, <span class="ruby-constant">User</span>.<span class="ruby-identifier">digest</span>(<span class="ruby-identifier">reset_token</span>))
  <span class="ruby-identifier">update_attribute</span>(<span class="ruby-value">:reset_sent_at</span>, <span class="ruby-constant">Time</span>.<span class="ruby-identifier">zone</span>.<span class="ruby-identifier">now</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-feed" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">feed</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Returns a user’s status feed.</p>

          <div class="method-source-code" id="feed-source">
            <pre><span class="ruby-comment"># File app/models/user.rb, line 109</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">feed</span>
  <span class="ruby-constant">Video</span>.<span class="ruby-identifier">where</span>(<span class="ruby-value">user_id:</span> <span class="ruby-identifier">id</span>).<span class="ruby-identifier">order</span>(<span class="ruby-value">created_at:</span> <span class="ruby-value">:desc</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-forget" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">forget</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Forgets a user.</p>

          <div class="method-source-code" id="forget-source">
            <pre><span class="ruby-comment"># File app/models/user.rb, line 76</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">forget</span>
  <span class="ruby-identifier">update_attribute</span>(<span class="ruby-value">:remember_digest</span>, <span class="ruby-keyword">nil</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-password_reset_expired-3F" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">password_reset_expired?</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Returns true if a password reset has expired.</p>

          <div class="method-source-code" id="password_reset_expired-3F-source">
            <pre><span class="ruby-comment"># File app/models/user.rb, line 104</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_reset_expired?</span>
  <span class="ruby-identifier">reset_sent_at</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">2</span>.<span class="ruby-identifier">hours</span>.<span class="ruby-identifier">ago</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-remember" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">remember</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Remembers a user in the database for use in persistent sessions.</p>

          <div class="method-source-code" id="remember-source">
            <pre><span class="ruby-comment"># File app/models/user.rb, line 56</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remember</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">remember_token</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">new_token</span>
  <span class="ruby-identifier">update_attribute</span>(<span class="ruby-value">:remember_digest</span>, <span class="ruby-constant">User</span>.<span class="ruby-identifier">digest</span>(<span class="ruby-identifier">remember_token</span>))
  <span class="ruby-identifier">remember_digest</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-send_activation_email" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">send_activation_email</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Sends activation email.</p>

          <div class="method-source-code" id="send_activation_email-source">
            <pre><span class="ruby-comment"># File app/models/user.rb, line 87</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">send_activation_email</span>
  <span class="ruby-constant">UserMailer</span>.<span class="ruby-identifier">account_activation</span>(<span class="ruby-keyword">self</span>).<span class="ruby-identifier">deliver_now</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-send_password_reset_email" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">send_password_reset_email</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Sends password reset email.</p>

          <div class="method-source-code" id="send_password_reset_email-source">
            <pre><span class="ruby-comment"># File app/models/user.rb, line 99</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">send_password_reset_email</span>
  <span class="ruby-constant">UserMailer</span>.<span class="ruby-identifier">password_reset</span>(<span class="ruby-keyword">self</span>).<span class="ruby-identifier">deliver_now</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

      <div id="method-i-session_token" class="method-detail ">
        <div class="method-header">
          <div class="method-heading">
            <span class="method-name">session_token</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
        </div>

        <div class="method-description">
          <p>Returns a session token to prevent session hijacking. We reuse the remember digest for convenience.</p>

          <div class="method-source-code" id="session_token-source">
            <pre><span class="ruby-comment"># File app/models/user.rb, line 64</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">session_token</span>
  <span class="ruby-identifier">remember_digest</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">remember</span>
<span class="ruby-keyword">end</span></pre>
          </div>
        </div>


      </div>

    </section>

  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.6.2.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

